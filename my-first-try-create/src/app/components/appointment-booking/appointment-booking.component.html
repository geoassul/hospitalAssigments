<div class="booking-container">
  <div class="progress-bar">
    <div class="progress-step" [class.active]="currentStep >= 1">1. Especialidad</div>
    <div class="progress-step" [class.active]="currentStep >= 2">2. Doctor</div>
    <div class="progress-step" [class.active]="currentStep >= 3">3. Fecha y Hora</div>
    <div class="progress-step" [class.active]="currentStep >= 4">4. Pago</div>
  </div>

  <!-- Step 1: Specialty Selection -->
  <div class="booking-step" *ngIf="currentStep === 1">
    <h2>Seleccione la Especialidad</h2>
    <div class="specialty-grid">
      <div 
        *ngFor="let specialty of specialties" 
        class="specialty-card"
        [class.selected]="selectedSpecialty?.id === specialty.id"
        (click)="selectSpecialty(specialty)">
        <h3>{{specialty.nombre}}</h3>
        <p>{{specialty.descripcion}}</p>
      </div>
    </div>
    <div class="buttons">
      <button class="next-button" [disabled]="!selectedSpecialty" (click)="nextStep()">
        Siguiente
      </button>
    </div>
  </div>

  <!-- Step 2: Doctor Selection -->
  <div class="booking-step" *ngIf="currentStep === 2">
    <h2>Seleccione el Doctor</h2>
    <div class="doctor-grid">
      <div 
        *ngFor="let doctor of doctors" 
        class="doctor-card"
        [class.selected]="selectedDoctor?.id === doctor.id"
        (click)="selectDoctor(doctor)">
        <h3>Dr. {{doctor.nombre}} {{doctor.apellido}}</h3>
      </div>
    </div>
    <div class="buttons">
      <button class="back-button" (click)="previousStep()">Anterior</button>
      <button class="next-button" [disabled]="!selectedDoctor" (click)="nextStep()">
        Siguiente
      </button>
    </div>
  </div>

  <!-- Step 3: Date and Time Selection -->
  <div class="booking-step" *ngIf="currentStep === 3">
    <h2>Seleccione Fecha y Hora</h2>
    <div class="datetime-selector">
      <div class="date-picker">
        <label>Fecha:</label>
        <input 
          type="date" 
          [(ngModel)]="selectedDate"
          (change)="loadTimeSlots()"
          [min]="minDate">
      </div>
      <div class="time-slots" *ngIf="selectedDate">
        <label>Hora disponible:</label>
        <div class="time-grid">
          <button 
            *ngFor="let slot of timeSlots"
            class="time-slot"
            [class.selected]="selectedTime === slot"
            (click)="selectTime(slot)">
            {{slot | date:'shortTime'}}
          </button>
        </div>
      </div>
    </div>
    <div class="buttons">
      <button class="back-button" (click)="previousStep()">Anterior</button>
      <button class="next-button" [disabled]="!selectedTime" (click)="nextStep()">
        Siguiente
      </button>
    </div>
  </div>

  <!-- Step 4: Payment Method -->
  <div class="booking-step" *ngIf="currentStep === 4">
    <h2>Método de Pago</h2>
    <div class="payment-grid">
      <div 
        *ngFor="let method of paymentMethods" 
        class="payment-card"
        [class.selected]="selectedPayment?.id === method.id"
        (click)="selectPayment(method)">
        <h3>{{method.nombre}}</h3>
        <p>{{method.descripcion}}</p>
      </div>
    </div>
    <div class="appointment-summary" *ngIf="selectedPayment">
      <h3>Resumen de la Cita</h3>
      <p><strong>Especialidad:</strong> {{selectedSpecialty?.nombre}}</p>
      <p><strong>Doctor:</strong> Dr. {{selectedDoctor?.nombre}} {{selectedDoctor?.apellido}}</p>
      <p><strong>Fecha:</strong> {{selectedDate | date:'mediumDate'}}</p>
      <p><strong>Hora:</strong> {{selectedTime | date:'shortTime'}}</p>
      <p><strong>Método de Pago:</strong> {{selectedPayment.nombre}}</p>
    </div>
    <div class="buttons">
      <button class="back-button" (click)="previousStep()">Anterior</button>
      <button class="confirm-button" [disabled]="!selectedPayment" (click)="confirmAppointment()">
        Confirmar Cita
      </button>
    </div>
  </div>
</div>